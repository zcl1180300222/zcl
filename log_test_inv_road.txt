2024-09-23 20:18:20,794 - ==> Logging on master GPU: 0
2024-09-23 20:18:20,794 - ==> Running Trainer: InvADTrainer
2024-09-23 20:18:20,794 - ==> Using GPU: [0] for Training
2024-09-23 20:18:20,794 - ==> Building model
2024-09-23 20:18:22,086 - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/wide_resnet50_racm-8234f177.pth)
2024-09-23 20:18:22,928 - ==> Load checkpoint: /data/x2/ader/runs/InvADTrainer_configs_invad_invad_mvtec_20240923-153312/net.pth
2024-09-23 20:18:24,476 - 
------------------------------------ InvAD ------------------------------------
| module                                   | #parameters or shape    | #flops       |
|:-----------------------------------------|:------------------------|:-------------|
| model                                    | 95.631M                 | 45.394G      |
|  net_encoder                             |  24.863M                |  12.034G     |
|   net_encoder.conv1                      |   9.408K                |   0.154G     |
|    net_encoder.conv1.weight              |    (64, 3, 7, 7)        |              |
|   net_encoder.bn1                        |   0.128K                |   2.097M     |
|    net_encoder.bn1.weight                |    (64,)                |              |
|    net_encoder.bn1.bias                  |    (64,)                |              |
|   net_encoder.layer1                     |   0.634M                |   2.598G     |
|    net_encoder.layer1.0                  |    0.206M               |    0.845G    |
|     net_encoder.layer1.0.conv1           |     8.192K              |     33.554M  |
|      net_encoder.layer1.0.conv1.weight   |      (128, 64, 1, 1)    |              |
|     net_encoder.layer1.0.bn1             |     0.256K              |     1.049M   |
|      net_encoder.layer1.0.bn1.weight     |      (128,)             |              |
|      net_encoder.layer1.0.bn1.bias       |      (128,)             |              |
|     net_encoder.layer1.0.conv2           |     0.147M              |     0.604G   |
|      net_encoder.layer1.0.conv2.weight   |      (128, 128, 3, 3)   |              |
|     net_encoder.layer1.0.bn2             |     0.256K              |     1.049M   |
|      net_encoder.layer1.0.bn2.weight     |      (128,)             |              |
|      net_encoder.layer1.0.bn2.bias       |      (128,)             |              |
|     net_encoder.layer1.0.conv3           |     32.768K             |     0.134G   |
|      net_encoder.layer1.0.conv3.weight   |      (256, 128, 1, 1)   |              |
|     net_encoder.layer1.0.bn3             |     0.512K              |     2.097M   |
|      net_encoder.layer1.0.bn3.weight     |      (256,)             |              |
|      net_encoder.layer1.0.bn3.bias       |      (256,)             |              |
|     net_encoder.layer1.0.downsample      |     16.896K             |     69.206M  |
|      net_encoder.layer1.0.downsample.0   |      16.384K            |      67.109M |
|      net_encoder.layer1.0.downsample.1   |      0.512K             |      2.097M  |
|    net_encoder.layer1.1                  |    0.214M               |    0.877G    |
|     net_encoder.layer1.1.conv1           |     32.768K             |     0.134G   |
|      net_encoder.layer1.1.conv1.weight   |      (128, 256, 1, 1)   |              |
|     net_encoder.layer1.1.bn1             |     0.256K              |     1.049M   |
|      net_encoder.layer1.1.bn1.weight     |      (128,)             |              |
|      net_encoder.layer1.1.bn1.bias       |      (128,)             |              |
|     net_encoder.layer1.1.conv2           |     0.147M              |     0.604G   |
|      net_encoder.layer1.1.conv2.weight   |      (128, 128, 3, 3)   |              |
|     net_encoder.layer1.1.bn2             |     0.256K              |     1.049M   |
|      net_encoder.layer1.1.bn2.weight     |      (128,)             |              |
|      net_encoder.layer1.1.bn2.bias       |      (128,)             |              |
|     net_encoder.layer1.1.conv3           |     32.768K             |     0.134G   |
|      net_encoder.layer1.1.conv3.weight   |      (256, 128, 1, 1)   |              |
|     net_encoder.layer1.1.bn3             |     0.512K              |     2.097M   |
|      net_encoder.layer1.1.bn3.weight     |      (256,)             |              |
|      net_encoder.layer1.1.bn3.bias       |      (256,)             |              |
|    net_encoder.layer1.2                  |    0.214M               |    0.877G    |
|     net_encoder.layer1.2.conv1           |     32.768K             |     0.134G   |
|      net_encoder.layer1.2.conv1.weight   |      (128, 256, 1, 1)   |              |
|     net_encoder.layer1.2.bn1             |     0.256K              |     1.049M   |
|      net_encoder.layer1.2.bn1.weight     |      (128,)             |              |
|      net_encoder.layer1.2.bn1.bias       |      (128,)             |              |
|     net_encoder.layer1.2.conv2           |     0.147M              |     0.604G   |
|      net_encoder.layer1.2.conv2.weight   |      (128, 128, 3, 3)   |              |
|     net_encoder.layer1.2.bn2             |     0.256K              |     1.049M   |
|      net_encoder.layer1.2.bn2.weight     |      (128,)             |              |
|      net_encoder.layer1.2.bn2.bias       |      (128,)             |              |
|     net_encoder.layer1.2.conv3           |     32.768K             |     0.134G   |
|      net_encoder.layer1.2.conv3.weight   |      (256, 128, 1, 1)   |              |
|     net_encoder.layer1.2.bn3             |     0.512K              |     2.097M   |
|      net_encoder.layer1.2.bn3.weight     |      (256,)             |              |
|      net_encoder.layer1.2.bn3.bias       |      (256,)             |              |
|   net_encoder.layer2                     |   3.483M                |   3.769G     |
|    net_encoder.layer2.0                  |    0.921M               |    1.146G    |
|     net_encoder.layer2.0.conv1           |     65.536K             |     0.268G   |
|      net_encoder.layer2.0.conv1.weight   |      (256, 256, 1, 1)   |              |
|     net_encoder.layer2.0.bn1             |     0.512K              |     2.097M   |
|      net_encoder.layer2.0.bn1.weight     |      (256,)             |              |
|      net_encoder.layer2.0.bn1.bias       |      (256,)             |              |
|     net_encoder.layer2.0.conv2           |     0.59M               |     0.604G   |
|      net_encoder.layer2.0.conv2.weight   |      (256, 256, 3, 3)   |              |
|     net_encoder.layer2.0.bn2             |     0.512K              |     0.524M   |
|      net_encoder.layer2.0.bn2.weight     |      (256,)             |              |
|      net_encoder.layer2.0.bn2.bias       |      (256,)             |              |
|     net_encoder.layer2.0.conv3           |     0.131M              |     0.134G   |
|      net_encoder.layer2.0.conv3.weight   |      (512, 256, 1, 1)   |              |
|     net_encoder.layer2.0.bn3             |     1.024K              |     1.049M   |
|      net_encoder.layer2.0.bn3.weight     |      (512,)             |              |
|      net_encoder.layer2.0.bn3.bias       |      (512,)             |              |
|     net_encoder.layer2.0.downsample      |     0.132M              |     0.135G   |
|      net_encoder.layer2.0.downsample.0   |      0.131M             |      0.134G  |
|      net_encoder.layer2.0.downsample.1   |      1.024K             |      1.049M  |
|    net_encoder.layer2.1                  |    0.854M               |    0.875G    |
|     net_encoder.layer2.1.conv1           |     0.131M              |     0.134G   |
|      net_encoder.layer2.1.conv1.weight   |      (256, 512, 1, 1)   |              |
|     net_encoder.layer2.1.bn1             |     0.512K              |     0.524M   |
|      net_encoder.layer2.1.bn1.weight     |      (256,)             |              |
|      net_encoder.layer2.1.bn1.bias       |      (256,)             |              |
|     net_encoder.layer2.1.conv2           |     0.59M               |     0.604G   |
|      net_encoder.layer2.1.conv2.weight   |      (256, 256, 3, 3)   |              |
|     net_encoder.layer2.1.bn2             |     0.512K              |     0.524M   |
|      net_encoder.layer2.1.bn2.weight     |      (256,)             |              |
|      net_encoder.layer2.1.bn2.bias       |      (256,)             |              |
|     net_encoder.layer2.1.conv3           |     0.131M              |     0.134G   |
|      net_encoder.layer2.1.conv3.weight   |      (512, 256, 1, 1)   |              |
|     net_encoder.layer2.1.bn3             |     1.024K              |     1.049M   |
|      net_encoder.layer2.1.bn3.weight     |      (512,)             |              |
|      net_encoder.layer2.1.bn3.bias       |      (512,)             |              |
|    net_encoder.layer2.2                  |    0.854M               |    0.875G    |
|     net_encoder.layer2.2.conv1           |     0.131M              |     0.134G   |
|      net_encoder.layer2.2.conv1.weight   |      (256, 512, 1, 1)   |              |
|     net_encoder.layer2.2.bn1             |     0.512K              |     0.524M   |
|      net_encoder.layer2.2.bn1.weight     |      (256,)             |              |
|      net_encoder.layer2.2.bn1.bias       |      (256,)             |              |
|     net_encoder.layer2.2.conv2           |     0.59M               |     0.604G   |
|      net_encoder.layer2.2.conv2.weight   |      (256, 256, 3, 3)   |              |
|     net_encoder.layer2.2.bn2             |     0.512K              |     0.524M   |
|      net_encoder.layer2.2.bn2.weight     |      (256,)             |              |
|      net_encoder.layer2.2.bn2.bias       |      (256,)             |              |
|     net_encoder.layer2.2.conv3           |     0.131M              |     0.134G   |
|      net_encoder.layer2.2.conv3.weight   |      (512, 256, 1, 1)   |              |
|     net_encoder.layer2.2.bn3             |     1.024K              |     1.049M   |
|      net_encoder.layer2.2.bn3.weight     |      (512,)             |              |
|      net_encoder.layer2.2.bn3.bias       |      (512,)             |              |
|    net_encoder.layer2.3                  |    0.854M               |    0.875G    |
|     net_encoder.layer2.3.conv1           |     0.131M              |     0.134G   |
|      net_encoder.layer2.3.conv1.weight   |      (256, 512, 1, 1)   |              |
|     net_encoder.layer2.3.bn1             |     0.512K              |     0.524M   |
|      net_encoder.layer2.3.bn1.weight     |      (256,)             |              |
|      net_encoder.layer2.3.bn1.bias       |      (256,)             |              |
|     net_encoder.layer2.3.conv2           |     0.59M               |     0.604G   |
|      net_encoder.layer2.3.conv2.weight   |      (256, 256, 3, 3)   |              |
|     net_encoder.layer2.3.bn2             |     0.512K              |     0.524M   |
|      net_encoder.layer2.3.bn2.weight     |      (256,)             |              |
|      net_encoder.layer2.3.bn2.bias       |      (256,)             |              |
|     net_encoder.layer2.3.conv3           |     0.131M              |     0.134G   |
|      net_encoder.layer2.3.conv3.weight   |      (512, 256, 1, 1)   |              |
|     net_encoder.layer2.3.bn3             |     1.024K              |     1.049M   |
|      net_encoder.layer2.3.bn3.weight     |      (512,)             |              |
|      net_encoder.layer2.3.bn3.bias       |      (512,)             |              |
|   net_encoder.layer3                     |   20.736M               |   5.511G     |
|    net_encoder.layer3.0                  |    3.676M               |    1.143G    |
|     net_encoder.layer3.0.conv1           |     0.262M              |     0.268G   |
|      net_encoder.layer3.0.conv1.weight   |      (512, 512, 1, 1)   |              |
|     net_encoder.layer3.0.bn1             |     1.024K              |     1.049M   |
|      net_encoder.layer3.0.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.0.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.0.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.0.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.0.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.0.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.0.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.0.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.0.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.0.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.0.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.0.bn3.bias       |      (1024,)            |              |
|     net_encoder.layer3.0.downsample      |     0.526M              |     0.135G   |
|      net_encoder.layer3.0.downsample.0   |      0.524M             |      0.134G  |
|      net_encoder.layer3.0.downsample.1   |      2.048K             |      0.524M  |
|    net_encoder.layer3.1                  |    3.412M               |    0.873G    |
|     net_encoder.layer3.1.conv1           |     0.524M              |     0.134G   |
|      net_encoder.layer3.1.conv1.weight   |      (512, 1024, 1, 1)  |              |
|     net_encoder.layer3.1.bn1             |     1.024K              |     0.262M   |
|      net_encoder.layer3.1.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.1.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.1.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.1.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.1.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.1.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.1.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.1.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.1.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.1.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.1.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.1.bn3.bias       |      (1024,)            |              |
|    net_encoder.layer3.2                  |    3.412M               |    0.873G    |
|     net_encoder.layer3.2.conv1           |     0.524M              |     0.134G   |
|      net_encoder.layer3.2.conv1.weight   |      (512, 1024, 1, 1)  |              |
|     net_encoder.layer3.2.bn1             |     1.024K              |     0.262M   |
|      net_encoder.layer3.2.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.2.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.2.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.2.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.2.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.2.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.2.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.2.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.2.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.2.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.2.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.2.bn3.bias       |      (1024,)            |              |
|    net_encoder.layer3.3                  |    3.412M               |    0.873G    |
|     net_encoder.layer3.3.conv1           |     0.524M              |     0.134G   |
|      net_encoder.layer3.3.conv1.weight   |      (512, 1024, 1, 1)  |              |
|     net_encoder.layer3.3.bn1             |     1.024K              |     0.262M   |
|      net_encoder.layer3.3.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.3.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.3.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.3.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.3.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.3.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.3.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.3.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.3.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.3.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.3.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.3.bn3.bias       |      (1024,)            |              |
|    net_encoder.layer3.4                  |    3.412M               |    0.873G    |
|     net_encoder.layer3.4.conv1           |     0.524M              |     0.134G   |
|      net_encoder.layer3.4.conv1.weight   |      (512, 1024, 1, 1)  |              |
|     net_encoder.layer3.4.bn1             |     1.024K              |     0.262M   |
|      net_encoder.layer3.4.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.4.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.4.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.4.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.4.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.4.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.4.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.4.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.4.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.4.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.4.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.4.bn3.bias       |      (1024,)            |              |
|    net_encoder.layer3.5                  |    3.412M               |    0.873G    |
|     net_encoder.layer3.5.conv1           |     0.524M              |     0.134G   |
|      net_encoder.layer3.5.conv1.weight   |      (512, 1024, 1, 1)  |              |
|     net_encoder.layer3.5.bn1             |     1.024K              |     0.262M   |
|      net_encoder.layer3.5.bn1.weight     |      (512,)             |              |
|      net_encoder.layer3.5.bn1.bias       |      (512,)             |              |
|     net_encoder.layer3.5.conv2           |     2.359M              |     0.604G   |
|      net_encoder.layer3.5.conv2.weight   |      (512, 512, 3, 3)   |              |
|     net_encoder.layer3.5.bn2             |     1.024K              |     0.262M   |
|      net_encoder.layer3.5.bn2.weight     |      (512,)             |              |
|      net_encoder.layer3.5.bn2.bias       |      (512,)             |              |
|     net_encoder.layer3.5.conv3           |     0.524M              |     0.134G   |
|      net_encoder.layer3.5.conv3.weight   |      (1024, 512, 1, 1)  |              |
|     net_encoder.layer3.5.bn3             |     2.048K              |     0.524M   |
|      net_encoder.layer3.5.bn3.weight     |      (1024,)            |              |
|      net_encoder.layer3.5.bn3.bias       |      (1024,)            |              |
|  net_fuser                               |  3.492M                 |  1.092G      |
|   net_fuser.downsamples                  |   3.151M                |   0.806G     |
|    net_fuser.downsamples.0               |    1.049M               |    0.269G    |
|     net_fuser.downsamples.0.conv         |     1.049M              |     0.268G   |
|      net_fuser.downsamples.0.conv.weight |      (256, 256, 4, 4)   |              |
|      net_fuser.downsamples.0.conv.bias   |      (256,)             |              |
|     net_fuser.downsamples.0.norm         |     0.512K              |     0.131M   |
|      net_fuser.downsamples.0.norm.weight |      (256,)             |              |
|      net_fuser.downsamples.0.norm.bias   |      (256,)             |              |
|    net_fuser.downsamples.1               |    1.05M                |    0.269G    |
|     net_fuser.downsamples.1.conv         |     1.049M              |     0.268G   |
|      net_fuser.downsamples.1.conv.weight |      (512, 512, 2, 2)   |              |
|      net_fuser.downsamples.1.conv.bias   |      (512,)             |              |
|     net_fuser.downsamples.1.norm         |     1.024K              |     0.262M   |
|      net_fuser.downsamples.1.norm.weight |      (512,)             |              |
|      net_fuser.downsamples.1.norm.bias   |      (512,)             |              |
|    net_fuser.downsamples.2               |    1.052M               |    0.269G    |
|     net_fuser.downsamples.2.conv         |     1.05M               |     0.268G   |
|      net_fuser.downsamples.2.conv.weight |      (1024, 1024, 1, 1) |              |
|      net_fuser.downsamples.2.conv.bias   |      (1024,)            |              |
|     net_fuser.downsamples.2.norm         |     2.048K              |     0.524M   |
|      net_fuser.downsamples.2.norm.weight |      (1024,)            |              |
|      net_fuser.downsamples.2.norm.bias   |      (1024,)            |              |
|   net_fuser.conv_cat                     |   0.115M                |   29.393M    |
|    net_fuser.conv_cat.conv               |    0.115M               |    29.36M    |
|     net_fuser.conv_cat.conv.weight       |     (64, 1792, 1, 1)    |              |
|    net_fuser.conv_cat.norm               |    0.128K               |    32.768K   |
|     net_fuser.conv_cat.norm.weight       |     (64,)               |              |
|     net_fuser.conv_cat.norm.bias         |     (64,)               |              |
|   net_fuser.conv_bottle.0                |   4.544K                |   1.163M     |
|    net_fuser.conv_bottle.0.conv1         |    1.024K               |    0.262M    |
|     net_fuser.conv_bottle.0.conv1.weight |     (16, 64, 1, 1)      |              |
|    net_fuser.conv_bottle.0.bn1           |    32                   |    8.192K    |
|     net_fuser.conv_bottle.0.bn1.weight   |     (16,)               |              |
|     net_fuser.conv_bottle.0.bn1.bias     |     (16,)               |              |
|    net_fuser.conv_bottle.0.conv2         |    2.304K               |    0.59M     |
|     net_fuser.conv_bottle.0.conv2.weight |     (16, 16, 3, 3)      |              |
|    net_fuser.conv_bottle.0.bn2           |    32                   |    8.192K    |
|     net_fuser.conv_bottle.0.bn2.weight   |     (16,)               |              |
|     net_fuser.conv_bottle.0.bn2.bias     |     (16,)               |              |
|    net_fuser.conv_bottle.0.conv3         |    1.024K               |    0.262M    |
|     net_fuser.conv_bottle.0.conv3.weight |     (64, 16, 1, 1)      |              |
|    net_fuser.conv_bottle.0.bn3           |    0.128K               |    32.768K   |
|     net_fuser.conv_bottle.0.bn3.weight   |     (64,)               |              |
|     net_fuser.conv_bottle.0.bn3.bias     |     (64,)               |              |
|   net_fuser.convs                        |   0.222M                |   0.255G     |
|    net_fuser.convs.0                     |    73.856K              |    18.874M   |
|     net_fuser.convs.0.0                  |     36.928K             |     9.437M   |
|      net_fuser.convs.0.0.0               |      36.864K            |      9.437M  |
|      net_fuser.convs.0.0.1               |      64                 |      0       |
|     net_fuser.convs.0.1                  |     36.928K             |     9.437M   |
|      net_fuser.convs.0.1.0               |      36.864K            |      9.437M  |
|      net_fuser.convs.0.1.1               |      64                 |      0       |
|    net_fuser.convs.1                     |    73.856K              |    47.186M   |
|     net_fuser.convs.1.0                  |     36.928K             |     9.437M   |
|      net_fuser.convs.1.0.0               |      36.864K            |      9.437M  |
|      net_fuser.convs.1.0.2               |      64                 |      0       |
|     net_fuser.convs.1.1                  |     36.928K             |     37.749M  |
|      net_fuser.convs.1.1.0               |      36.864K            |      37.749M |
|      net_fuser.convs.1.1.1               |      64                 |      0       |
|    net_fuser.convs.2                     |    73.856K              |    0.189G    |
|     net_fuser.convs.2.0                  |     36.928K             |     37.749M  |
|      net_fuser.convs.2.0.0               |      36.864K            |      37.749M |
|      net_fuser.convs.2.0.2               |      64                 |      0       |
|     net_fuser.convs.2.1                  |     36.928K             |     0.151G   |
|      net_fuser.convs.2.1.0               |      36.864K            |      0.151G  |
|      net_fuser.convs.2.1.1               |      64                 |      0       |
|  net_decoder                             |  67.277M                |  32.268G     |
|   net_decoder.input                      |   0.262M                |   0          |
|    net_decoder.input.input               |    (1, 1024, 16, 16)    |              |
|   net_decoder.conv1.0                    |   9.438M                |   2.416G     |
|    net_decoder.conv1.0.0                 |    9.437M               |    2.416G    |
|     net_decoder.conv1.0.0.weight         |     (1024, 1024, 3, 3)  |              |
|    net_decoder.conv1.0.1                 |    1.024K               |    0         |
|     net_decoder.conv1.0.1.bias           |     (1024,)             |              |
|   net_decoder.convs_latent               |   0.138M                |   0.248G     |
|    net_decoder.convs_latent.0            |    46.16K               |    11.796M   |
|     net_decoder.convs_latent.0.0         |     36.928K             |     9.437M   |
|      net_decoder.convs_latent.0.0.0      |      36.864K            |      9.437M  |
|      net_decoder.convs_latent.0.0.1      |      64                 |      0       |
|     net_decoder.convs_latent.0.1         |     9.232K              |     2.359M   |
|      net_decoder.convs_latent.0.1.0      |      9.216K             |      2.359M  |
|      net_decoder.convs_latent.0.1.1      |      16                 |      0       |
|    net_decoder.convs_latent.1            |    46.16K               |    47.186M   |
|     net_decoder.convs_latent.1.0         |     36.928K             |     37.749M  |
|      net_decoder.convs_latent.1.0.0      |      36.864K            |      37.749M |
|      net_decoder.convs_latent.1.0.1      |      64                 |      0       |
|     net_decoder.convs_latent.1.1         |     9.232K              |     9.437M   |
|      net_decoder.convs_latent.1.1.0      |      9.216K             |      9.437M  |
|      net_decoder.convs_latent.1.1.1      |      16                 |      0       |
|    net_decoder.convs_latent.2            |    46.16K               |    0.189G    |
|     net_decoder.convs_latent.2.0         |     36.928K             |     0.151G   |
|      net_decoder.convs_latent.2.0.0      |      36.864K            |      0.151G  |
|      net_decoder.convs_latent.2.0.1      |      64                 |      0       |
|     net_decoder.convs_latent.2.1         |     9.232K              |     37.749M  |
|      net_decoder.convs_latent.2.1.0      |      9.216K             |      37.749M |
|      net_decoder.convs_latent.2.1.1      |      16                 |      0       |
|   net_decoder.convs                      |   57.438M               |   29.604G    |
|    net_decoder.convs.0                   |    41.038M              |    10.507G   |
|     net_decoder.convs.0.0                |     20.519M             |     5.253G   |
|      net_decoder.convs.0.0.conv1         |      9.735M             |      2.492G  |
|      net_decoder.convs.0.0.conv2         |      9.735M             |      2.492G  |
|      net_decoder.convs.0.0.skip.0        |      1.049M             |      0.268G  |
|     net_decoder.convs.0.1                |     20.519M             |     5.253G   |
|      net_decoder.convs.0.1.conv1         |      9.735M             |      2.492G  |
|      net_decoder.convs.0.1.conv2         |      9.735M             |      2.492G  |
|      net_decoder.convs.0.1.skip.0        |      1.049M             |      0.268G  |
|    net_decoder.convs.1                   |    13.03M               |    9.319G    |
|     net_decoder.convs.1.0                |     7.752M              |     3.912G   |
|      net_decoder.convs.1.0.conv1         |      4.719M             |      1.209G  |
|      net_decoder.convs.1.0.conv2         |      2.508M             |      2.569G  |
|      net_decoder.convs.1.0.skip.0        |      0.524M             |      0.134G  |
|     net_decoder.convs.1.1                |     5.279M              |     5.406G   |
|      net_decoder.convs.1.1.conv1         |      2.508M             |      2.569G  |
|      net_decoder.convs.1.1.conv2         |      2.508M             |      2.569G  |
|      net_decoder.convs.1.1.skip.0        |      0.262M             |      0.268G  |
|    net_decoder.convs.2                   |    3.369M               |    9.779G    |
|     net_decoder.convs.2.0                |     1.975M              |     4.066G   |
|      net_decoder.convs.2.0.conv1         |      1.18M              |      1.21G   |
|      net_decoder.convs.2.0.conv2         |      0.664M             |      2.722G  |
|      net_decoder.convs.2.0.skip.0        |      0.131M             |      0.134G  |
|     net_decoder.convs.2.1                |     1.394M              |     5.713G   |
|      net_decoder.convs.2.1.conv1         |      0.664M             |      2.722G  |
|      net_decoder.convs.2.1.conv2         |      0.664M             |      2.722G  |
|      net_decoder.convs.2.1.skip.0        |      65.536K            |      0.268G  |
-------------------------------------------------------------------------------
2024-09-23 20:18:24,478 - ==> Creating optimizer
2024-09-23 20:18:24,480 - ==> Loading dataset: DefaultAD
2024-09-23 20:18:24,488 - ==> ********** cfg ********** 
fvcore_is                            : True                                
fvcore_b                             : 1                                   
fvcore_c                             : 3                                   
epoch_full                           : 300                                 
metrics                              : ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px']
use_adeval                           : True                                
evaluator.kwargs                     : {'metrics': ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px'], 'pooling_ks': None, 'max_step_aupro': 100}
vis                                  : True                                
vis_dir                              : result/                             
optim.lr                             : 0.004                               
optim.kwargs                         : {'name': 'adam', 'betas': (0, 0.99)}
trainer.name                         : InvADTrainer                        
trainer.checkpoint                   : runs                                
trainer.logdir_sub                   :                                     
trainer.resume_dir                   :                                     
trainer.cuda_deterministic           : False                               
trainer.epoch_full                   : 300                                 
trainer.scheduler_kwargs             : {'name': 'step', 'lr_noise': None, 'noise_pct': 0.67, 'noise_std': 1.0, 'noise_seed': 42, 'lr_min': 4e-05, 'warmup_lr': 4e-06, 'warmup_iters': -1, 'cooldown_iters': 0, 'warmup_epochs': 0, 'cooldown_epochs': 0, 'use_iters': True, 'patience_iters': 0, 'patience_epochs': 0, 'decay_iters': 0, 'decay_epochs': 240, 'cycle_decay': 0.1, 'decay_rate': 0.1}
trainer.mixup_kwargs                 : {'mixup_alpha': 0.8, 'cutmix_alpha': 1.0, 'cutmix_minmax': None, 'prob': 0.0, 'switch_prob': 0.5, 'mode': 'batch', 'correct_lam': True, 'label_smoothing': 0.1}
trainer.test_start_epoch             : 300                                 
trainer.test_per_epoch               : 30                                  
trainer.find_unused_parameters       : False                               
trainer.sync_BN                      : apex                                
trainer.dist_BN                      :                                     
trainer.scaler                       : none                                
trainer.data.batch_size              : 32                                  
trainer.data.batch_size_per_gpu      : 32                                  
trainer.data.batch_size_test         : 32                                  
trainer.data.batch_size_per_gpu_test : 32                                  
trainer.data.num_workers_per_gpu     : 4                                   
trainer.data.drop_last               : True                                
trainer.data.pin_memory              : True                                
trainer.data.persistent_workers      : False                               
trainer.data.num_workers             : 4                                   
trainer.iter                         : 0                                   
trainer.epoch                        : 0                                   
trainer.iter_full                    : 17700                               
trainer.metric_recorder              : {'mAUROC_sp_max_road': [], 'mAP_sp_max_road': [], 'mF1_max_sp_max_road': [], 'mAUPRO_px_road': [], 'mAUROC_px_road': [], 'mAP_px_road': [], 'mF1_max_px_road': [], 'mF1_px_0.2_0.8_0.1_road': [], 'mAcc_px_0.2_0.8_0.1_road': [], 'mIoU_px_0.2_0.8_0.1_road': [], 'mIoU_max_px_road': []}
loss.loss_terms                      : [{'type': 'L2Loss', 'name': 'pixel', 'lam': 1.0}]
loss.clip_grad                       : 5.0                                 
loss.create_graph                    : False                               
loss.retain_graph                    : False                               
adv                                  : False                               
logging.log_terms_train              : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'data_t', 'fmt': ':>5.3f'}, {'name': 'optim_t', 'fmt': ':>5.3f'}, {'name': 'lr', 'fmt': ':>7.6f'}, {'name': 'pixel', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.log_terms_test               : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'pixel', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.train_reset_log_per          : 50                                  
logging.train_log_per                : 50                                  
logging.test_log_per                 : 50                                  
data.sampler                         : naive                               
data.loader_type                     : pil                                 
data.loader_type_target              : pil_L                               
data.type                            : DefaultAD                           
data.root                            : data/mvtec                          
data.meta                            : meta.json                           
data.cls_names                       : []                                  
data.train_transforms                : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.test_transforms                 : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.target_transforms               : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}]
data.train_size                      : 59                                  
data.test_size                       : 46                                  
data.train_length                    : 1896                                
data.test_length                     : 1472                                
model_encoder.name                   : timm_wide_resnet50_2                
model_encoder.kwargs                 : {'pretrained': True, 'checkpoint_path': '', 'strict': False, 'features_only': True, 'out_indices': [1, 2, 3]}
model_fuser                          : {'in_chas': [256, 512, 1024], 'style_chas': [64, 64, 64], 'in_strides': [4, 2, 1], 'down_conv': True, 'bottle_num': 1, 'conv_num': 1, 'lr_mul': 0.01}
model_decoder                        : {'in_chas': [256, 512, 1024], 'style_chas': [64, 64, 64], 'latent_spatial_size': 16, 'latent_channel_size': 16, 'blur_kernel': [1, 3, 3, 1], 'normalize_mode': 'LayerNorm', 'lr_mul': 0.01, 'small_generator': True, 'layers': [2, 2, 2]}
model_disor                          : {'sizes': [64, 32, 16], 'in_chas': [256, 512, 1024]}
model.name                           : invad                               
model.kwargs                         : {'pretrained': False, 'checkpoint_path': '/data/x2/ader/runs/InvADTrainer_configs_invad_invad_mvtec_20240923-153312/net.pth', 'strict': True, 'model_encoder': Namespace(name='timm_wide_resnet50_2', kwargs={'pretrained': True, 'checkpoint_path': '', 'strict': False, 'features_only': True, 'out_indices': [1, 2, 3]}), 'model_fuser': {'in_chas': [256, 512, 1024], 'style_chas': [64, 64, 64], 'in_strides': [4, 2, 1], 'down_conv': True, 'bottle_num': 1, 'conv_num': 1, 'lr_mul': 0.01}, 'model_decoder': {'in_chas': [256, 512, 1024], 'style_chas': [64, 64, 64], 'latent_spatial_size': 16, 'latent_channel_size': 16, 'blur_kernel': [1, 3, 3, 1], 'normalize_mode': 'LayerNorm', 'lr_mul': 0.01, 'small_generator': True, 'layers': [2, 2, 2]}}
seed                                 : 42                                  
size                                 : 256                                 
warmup_epochs                        : 0                                   
test_start_epoch                     : 300                                 
test_per_epoch                       : 30                                  
batch_train                          : 32                                  
batch_test_per                       : 32                                  
lr                                   : 0.004                               
weight_decay                         : 0.0001                              
uni_am                               : True                                
use_cos                              : True                                
cfg_path                             : configs.invad.invad_mvtec           
mode                                 : test                                
sleep                                : -1                                  
memory                               : -1                                  
dist_url                             : env://                              
logger_rank                          : 0                                   
opts                                 : ['vis=True', 'vis_dir=result/']     
command                              : python3 -m torch.distributed.launch --nproc_per_node=$nproc_per_node --nnodes=$nnodes --node_rank=$node_rank --master_addr=$master_addr --master_port=$master_port --use_env run.py -c configs.invad.invad_mvtec -m test --sleep -1 --memory -1 --dist_url env:// --logger_rank 0 vis=True vis_dir=result/
task_start_time                      : 1841828.486587034                   
dist                                 : False                               
world_size                           : 1                                   
rank                                 : 0                                   
local_rank                           : 0                                   
ngpus_per_node                       : 1                                   
nnodes                               : 1                                   
master                               : True                                
logdir                               : runs/InvADTrainer_configs_invad_invad_mvtec_20240923-201820
logger.filters                       : []                                  
logger.name                          : root                                
logger.level                         : 20                                  
logger.parent                        : None                                
logger.propagate                     : True                                
logger.disabled                      : False                               
logdir_train                         : runs/InvADTrainer_configs_invad_invad_mvtec_20240923-201820/show_train
logdir_test                          : runs/InvADTrainer_configs_invad_invad_mvtec_20240923-201820/show_test
2024-09-23 20:18:24,488 - ==> Starting testing with 1 nodes x 1 GPUs
2024-09-23 20:19:23,341 - Test: 100.00% [46/46] [batch_t 1.043 (1.278)] [pixel 9.057 (8.858)]
2024-09-23 20:23:43,256 - ==> Metric Time for road           :   0.003 (mAUROC_sp_max)	  0.001 (mAP_sp_max)	  0.001 (mF1_max_sp_max)	179.209 (mAUPRO_px)	 35.208 (mAUROC_px)	 25.946 (mAP_px)	  5.188 (mF1_max_px)	  1.755 (mF1_px_0.2_0.8_0.1)	  1.796 (mAcc_px_0.2_0.8_0.1)	  1.873 (mIoU_px_0.2_0.8_0.1)	  5.298 (mIoU_max_px)	
2024-09-23 20:23:43,287 - 
|  Name  |  mAUROC_sp_max  |  mAUROC_sp_max (Max)  |  mAP_sp_max  |  mAP_sp_max (Max)  |  mF1_max_sp_max  |  mF1_max_sp_max (Max)  |  mAUPRO_px  |  mAUPRO_px (Max)   |  mAUROC_px  |  mAUROC_px (Max)   |  mAP_px  |    mAP_px (Max)    |  mF1_max_px  |  mF1_max_px (Max)  |  mF1_px_0.2_0.8_0.1  |  mF1_px_0.2_0.8_0.1 (Max)  |  mAcc_px_0.2_0.8_0.1  |  mAcc_px_0.2_0.8_0.1 (Max)  |  mIoU_px_0.2_0.8_0.1  |  mIoU_px_0.2_0.8_0.1 (Max)  |  mIoU_max_px  |  mIoU_max_px (Max)  |
|:------:|:---------------:|:---------------------:|:------------:|:------------------:|:----------------:|:----------------------:|:-----------:|:------------------:|:-----------:|:------------------:|:--------:|:------------------:|:------------:|:------------------:|:--------------------:|:--------------------------:|:---------------------:|:---------------------------:|:---------------------:|:---------------------------:|:-------------:|:-------------------:|
|  road  |     85.965      |  85.965 (1   epoch)   |    94.625    | 94.625 (1   epoch) |      89.945      |   89.945 (1   epoch)   |   54.666    | 54.666 (1   epoch) |   86.802    | 86.802 (1   epoch) |  28.333  | 28.333 (1   epoch) |    34.512    | 34.512 (1   epoch) |        14.941        |     14.941 (1   epoch)     |        37.668         |     37.668 (1   epoch)      |         8.527         |      8.527 (1   epoch)      |    20.855     | 20.855 (1   epoch)  |
