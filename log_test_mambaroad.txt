2024-09-23 20:16:02,532 - ==> Logging on master GPU: 0
2024-09-23 20:16:02,532 - ==> Running Trainer: MAMBAADTrainer
2024-09-23 20:16:02,532 - ==> Using GPU: [0] for Training
2024-09-23 20:16:02,532 - ==> Building model
2024-09-23 20:16:02,921 - Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet34-43635321.pth)
2024-09-23 20:16:03,419 - ==> Load checkpoint: /data/x2/ader/runs/MAMBAADTrainer_configs_mambaad_mambaad_mvtec_20240923-113322/net.pth
2024-09-23 20:16:05,480 - 
------------------------------------ MAMBAAD ------------------------------------
| module                                                      | #parameters or shape   | #flops       |
|:------------------------------------------------------------|:-----------------------|:-------------|
| model                                                       | 25.667M                | 8.3G         |
|  net_t                                                      |  8.17M                 |  3.955G      |
|   net_t.conv1                                               |   9.408K               |   0.154G     |
|    net_t.conv1.weight                                       |    (64, 3, 7, 7)       |              |
|   net_t.bn1                                                 |   0.128K               |   2.097M     |
|    net_t.bn1.weight                                         |    (64,)               |              |
|    net_t.bn1.bias                                           |    (64,)               |              |
|   net_t.layer1                                              |   0.222M               |   0.909G     |
|    net_t.layer1.0                                           |    73.984K             |    0.303G    |
|     net_t.layer1.0.conv1                                    |     36.864K            |     0.151G   |
|      net_t.layer1.0.conv1.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.0.bn1                                      |     0.128K             |     0.524M   |
|      net_t.layer1.0.bn1.weight                              |      (64,)             |              |
|      net_t.layer1.0.bn1.bias                                |      (64,)             |              |
|     net_t.layer1.0.conv2                                    |     36.864K            |     0.151G   |
|      net_t.layer1.0.conv2.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.0.bn2                                      |     0.128K             |     0.524M   |
|      net_t.layer1.0.bn2.weight                              |      (64,)             |              |
|      net_t.layer1.0.bn2.bias                                |      (64,)             |              |
|    net_t.layer1.1                                           |    73.984K             |    0.303G    |
|     net_t.layer1.1.conv1                                    |     36.864K            |     0.151G   |
|      net_t.layer1.1.conv1.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.1.bn1                                      |     0.128K             |     0.524M   |
|      net_t.layer1.1.bn1.weight                              |      (64,)             |              |
|      net_t.layer1.1.bn1.bias                                |      (64,)             |              |
|     net_t.layer1.1.conv2                                    |     36.864K            |     0.151G   |
|      net_t.layer1.1.conv2.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.1.bn2                                      |     0.128K             |     0.524M   |
|      net_t.layer1.1.bn2.weight                              |      (64,)             |              |
|      net_t.layer1.1.bn2.bias                                |      (64,)             |              |
|    net_t.layer1.2                                           |    73.984K             |    0.303G    |
|     net_t.layer1.2.conv1                                    |     36.864K            |     0.151G   |
|      net_t.layer1.2.conv1.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.2.bn1                                      |     0.128K             |     0.524M   |
|      net_t.layer1.2.bn1.weight                              |      (64,)             |              |
|      net_t.layer1.2.bn1.bias                                |      (64,)             |              |
|     net_t.layer1.2.conv2                                    |     36.864K            |     0.151G   |
|      net_t.layer1.2.conv2.weight                            |      (64, 64, 3, 3)    |              |
|     net_t.layer1.2.bn2                                      |     0.128K             |     0.524M   |
|      net_t.layer1.2.bn2.weight                              |      (64,)             |              |
|      net_t.layer1.2.bn2.bias                                |      (64,)             |              |
|   net_t.layer2                                              |   1.116M               |   1.143G     |
|    net_t.layer2.0                                           |    0.23M               |    0.236G    |
|     net_t.layer2.0.conv1                                    |     73.728K            |     75.497M  |
|      net_t.layer2.0.conv1.weight                            |      (128, 64, 3, 3)   |              |
|     net_t.layer2.0.bn1                                      |     0.256K             |     0.262M   |
|      net_t.layer2.0.bn1.weight                              |      (128,)            |              |
|      net_t.layer2.0.bn1.bias                                |      (128,)            |              |
|     net_t.layer2.0.conv2                                    |     0.147M             |     0.151G   |
|      net_t.layer2.0.conv2.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.0.bn2                                      |     0.256K             |     0.262M   |
|      net_t.layer2.0.bn2.weight                              |      (128,)            |              |
|      net_t.layer2.0.bn2.bias                                |      (128,)            |              |
|     net_t.layer2.0.downsample                               |     8.448K             |     8.651M   |
|      net_t.layer2.0.downsample.0                            |      8.192K            |      8.389M  |
|      net_t.layer2.0.downsample.1                            |      0.256K            |      0.262M  |
|    net_t.layer2.1                                           |    0.295M              |    0.303G    |
|     net_t.layer2.1.conv1                                    |     0.147M             |     0.151G   |
|      net_t.layer2.1.conv1.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.1.bn1                                      |     0.256K             |     0.262M   |
|      net_t.layer2.1.bn1.weight                              |      (128,)            |              |
|      net_t.layer2.1.bn1.bias                                |      (128,)            |              |
|     net_t.layer2.1.conv2                                    |     0.147M             |     0.151G   |
|      net_t.layer2.1.conv2.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.1.bn2                                      |     0.256K             |     0.262M   |
|      net_t.layer2.1.bn2.weight                              |      (128,)            |              |
|      net_t.layer2.1.bn2.bias                                |      (128,)            |              |
|    net_t.layer2.2                                           |    0.295M              |    0.303G    |
|     net_t.layer2.2.conv1                                    |     0.147M             |     0.151G   |
|      net_t.layer2.2.conv1.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.2.bn1                                      |     0.256K             |     0.262M   |
|      net_t.layer2.2.bn1.weight                              |      (128,)            |              |
|      net_t.layer2.2.bn1.bias                                |      (128,)            |              |
|     net_t.layer2.2.conv2                                    |     0.147M             |     0.151G   |
|      net_t.layer2.2.conv2.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.2.bn2                                      |     0.256K             |     0.262M   |
|      net_t.layer2.2.bn2.weight                              |      (128,)            |              |
|      net_t.layer2.2.bn2.bias                                |      (128,)            |              |
|    net_t.layer2.3                                           |    0.295M              |    0.303G    |
|     net_t.layer2.3.conv1                                    |     0.147M             |     0.151G   |
|      net_t.layer2.3.conv1.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.3.bn1                                      |     0.256K             |     0.262M   |
|      net_t.layer2.3.bn1.weight                              |      (128,)            |              |
|      net_t.layer2.3.bn1.bias                                |      (128,)            |              |
|     net_t.layer2.3.conv2                                    |     0.147M             |     0.151G   |
|      net_t.layer2.3.conv2.weight                            |      (128, 128, 3, 3)  |              |
|     net_t.layer2.3.bn2                                      |     0.256K             |     0.262M   |
|      net_t.layer2.3.bn2.weight                              |      (128,)            |              |
|      net_t.layer2.3.bn2.bias                                |      (128,)            |              |
|   net_t.layer3                                              |   6.822M               |   1.747G     |
|    net_t.layer3.0                                           |    0.919M              |    0.235G    |
|     net_t.layer3.0.conv1                                    |     0.295M             |     75.497M  |
|      net_t.layer3.0.conv1.weight                            |      (256, 128, 3, 3)  |              |
|     net_t.layer3.0.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.0.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.0.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.0.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.0.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.0.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.0.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.0.bn2.bias                                |      (256,)            |              |
|     net_t.layer3.0.downsample                               |     33.28K             |     8.52M    |
|      net_t.layer3.0.downsample.0                            |      32.768K           |      8.389M  |
|      net_t.layer3.0.downsample.1                            |      0.512K            |      0.131M  |
|    net_t.layer3.1                                           |    1.181M              |    0.302G    |
|     net_t.layer3.1.conv1                                    |     0.59M              |     0.151G   |
|      net_t.layer3.1.conv1.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.1.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.1.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.1.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.1.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.1.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.1.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.1.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.1.bn2.bias                                |      (256,)            |              |
|    net_t.layer3.2                                           |    1.181M              |    0.302G    |
|     net_t.layer3.2.conv1                                    |     0.59M              |     0.151G   |
|      net_t.layer3.2.conv1.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.2.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.2.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.2.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.2.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.2.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.2.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.2.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.2.bn2.bias                                |      (256,)            |              |
|    net_t.layer3.3                                           |    1.181M              |    0.302G    |
|     net_t.layer3.3.conv1                                    |     0.59M              |     0.151G   |
|      net_t.layer3.3.conv1.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.3.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.3.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.3.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.3.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.3.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.3.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.3.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.3.bn2.bias                                |      (256,)            |              |
|    net_t.layer3.4                                           |    1.181M              |    0.302G    |
|     net_t.layer3.4.conv1                                    |     0.59M              |     0.151G   |
|      net_t.layer3.4.conv1.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.4.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.4.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.4.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.4.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.4.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.4.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.4.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.4.bn2.bias                                |      (256,)            |              |
|    net_t.layer3.5                                           |    1.181M              |    0.302G    |
|     net_t.layer3.5.conv1                                    |     0.59M              |     0.151G   |
|      net_t.layer3.5.conv1.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.5.bn1                                      |     0.512K             |     0.131M   |
|      net_t.layer3.5.bn1.weight                              |      (256,)            |              |
|      net_t.layer3.5.bn1.bias                                |      (256,)            |              |
|     net_t.layer3.5.conv2                                    |     0.59M              |     0.151G   |
|      net_t.layer3.5.conv2.weight                            |      (256, 256, 3, 3)  |              |
|     net_t.layer3.5.bn2                                      |     0.512K             |     0.131M   |
|      net_t.layer3.5.bn2.weight                              |      (256,)            |              |
|      net_t.layer3.5.bn2.bias                                |      (256,)            |              |
|  mff_oce                                                    |  1.458M                |  0.269G      |
|   mff_oce.bn_layer                                          |   0.94M                |   66.47M     |
|    mff_oce.bn_layer.0                                       |    0.379M              |    30.622M   |
|     mff_oce.bn_layer.0.conv1                                |     32.768K            |     8.389M   |
|      mff_oce.bn_layer.0.conv1.weight                        |      (128, 256, 1, 1)  |              |
|     mff_oce.bn_layer.0.bn1                                  |     0.256K             |     65.536K  |
|      mff_oce.bn_layer.0.bn1.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.0.bn1.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.0.conv2                                |     0.147M             |     9.437M   |
|      mff_oce.bn_layer.0.conv2.weight                        |      (128, 128, 3, 3)  |              |
|     mff_oce.bn_layer.0.bn2                                  |     0.256K             |     16.384K  |
|      mff_oce.bn_layer.0.bn2.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.0.bn2.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.0.conv3                                |     65.536K            |     4.194M   |
|      mff_oce.bn_layer.0.conv3.weight                        |      (512, 128, 1, 1)  |              |
|     mff_oce.bn_layer.0.bn3                                  |     1.024K             |     65.536K  |
|      mff_oce.bn_layer.0.bn3.weight                          |      (512,)            |              |
|      mff_oce.bn_layer.0.bn3.bias                            |      (512,)            |              |
|     mff_oce.bn_layer.0.downsample                           |     0.132M             |     8.454M   |
|      mff_oce.bn_layer.0.downsample.0                        |      0.131M            |      8.389M  |
|      mff_oce.bn_layer.0.downsample.1                        |      1.024K            |      65.536K |
|    mff_oce.bn_layer.1                                       |    0.28M               |    17.924M   |
|     mff_oce.bn_layer.1.conv1                                |     65.536K            |     4.194M   |
|      mff_oce.bn_layer.1.conv1.weight                        |      (128, 512, 1, 1)  |              |
|     mff_oce.bn_layer.1.bn1                                  |     0.256K             |     16.384K  |
|      mff_oce.bn_layer.1.bn1.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.1.bn1.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.1.conv2                                |     0.147M             |     9.437M   |
|      mff_oce.bn_layer.1.conv2.weight                        |      (128, 128, 3, 3)  |              |
|     mff_oce.bn_layer.1.bn2                                  |     0.256K             |     16.384K  |
|      mff_oce.bn_layer.1.bn2.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.1.bn2.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.1.conv3                                |     65.536K            |     4.194M   |
|      mff_oce.bn_layer.1.conv3.weight                        |      (512, 128, 1, 1)  |              |
|     mff_oce.bn_layer.1.bn3                                  |     1.024K             |     65.536K  |
|      mff_oce.bn_layer.1.bn3.weight                          |      (512,)            |              |
|      mff_oce.bn_layer.1.bn3.bias                            |      (512,)            |              |
|    mff_oce.bn_layer.2                                       |    0.28M               |    17.924M   |
|     mff_oce.bn_layer.2.conv1                                |     65.536K            |     4.194M   |
|      mff_oce.bn_layer.2.conv1.weight                        |      (128, 512, 1, 1)  |              |
|     mff_oce.bn_layer.2.bn1                                  |     0.256K             |     16.384K  |
|      mff_oce.bn_layer.2.bn1.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.2.bn1.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.2.conv2                                |     0.147M             |     9.437M   |
|      mff_oce.bn_layer.2.conv2.weight                        |      (128, 128, 3, 3)  |              |
|     mff_oce.bn_layer.2.bn2                                  |     0.256K             |     16.384K  |
|      mff_oce.bn_layer.2.bn2.weight                          |      (128,)            |              |
|      mff_oce.bn_layer.2.bn2.bias                            |      (128,)            |              |
|     mff_oce.bn_layer.2.conv3                                |     65.536K            |     4.194M   |
|      mff_oce.bn_layer.2.conv3.weight                        |      (512, 128, 1, 1)  |              |
|     mff_oce.bn_layer.2.bn3                                  |     1.024K             |     65.536K  |
|      mff_oce.bn_layer.2.bn3.weight                          |      (512,)            |              |
|      mff_oce.bn_layer.2.bn3.bias                            |      (512,)            |              |
|   mff_oce.conv1                                             |   73.728K              |   75.497M    |
|    mff_oce.conv1.weight                                     |    (128, 64, 3, 3)     |              |
|   mff_oce.bn1                                               |   0.256K               |   0.262M     |
|    mff_oce.bn1.weight                                       |    (128,)              |              |
|    mff_oce.bn1.bias                                         |    (128,)              |              |
|   mff_oce.conv2                                             |   0.295M               |   75.497M    |
|    mff_oce.conv2.weight                                     |    (256, 128, 3, 3)    |              |
|   mff_oce.bn2                                               |   0.512K               |   0.131M     |
|    mff_oce.bn2.weight                                       |    (256,)              |              |
|    mff_oce.bn2.bias                                         |    (256,)              |              |
|   mff_oce.conv21                                            |   16.512K              |   16.777M    |
|    mff_oce.conv21.weight                                    |    (128, 128, 1, 1)    |              |
|    mff_oce.conv21.bias                                      |    (128,)              |              |
|   mff_oce.bn21                                              |   0.256K               |   0.262M     |
|    mff_oce.bn21.weight                                      |    (128,)              |              |
|    mff_oce.bn21.bias                                        |    (128,)              |              |
|   mff_oce.conv31                                            |   65.792K              |   16.777M    |
|    mff_oce.conv31.weight                                    |    (256, 256, 1, 1)    |              |
|    mff_oce.conv31.bias                                      |    (256,)              |              |
|   mff_oce.bn31                                              |   0.512K               |   0.131M     |
|    mff_oce.bn31.weight                                      |    (256,)              |              |
|    mff_oce.bn31.bias                                        |    (256,)              |              |
|   mff_oce.convf                                             |   65.792K              |   16.777M    |
|    mff_oce.convf.weight                                     |    (256, 256, 1, 1)    |              |
|    mff_oce.convf.bias                                       |    (256,)              |              |
|   mff_oce.bnf                                               |   0.512K               |   0.131M     |
|    mff_oce.bnf.weight                                       |    (256,)              |              |
|    mff_oce.bnf.bias                                         |    (256,)              |              |
|  net_s.layers_up                                            |  16.038M               |  4.076G      |
|   net_s.layers_up.0.blocks.0                                |   9.441M               |   0.577G     |
|    net_s.layers_up.0.blocks.0.smm_blocks                    |    7.561M              |    0.456G    |
|     net_s.layers_up.0.blocks.0.smm_blocks.0                 |     2.52M              |     0.152G   |
|      net_s.layers_up.0.blocks.0.smm_blocks.0.ln_1           |      1.024K            |      0.164M  |
|      net_s.layers_up.0.blocks.0.smm_blocks.0.self_attention |      2.519M            |      0.152G  |
|     net_s.layers_up.0.blocks.0.smm_blocks.1                 |     2.52M              |     0.152G   |
|      net_s.layers_up.0.blocks.0.smm_blocks.1.ln_1           |      1.024K            |      0.164M  |
|      net_s.layers_up.0.blocks.0.smm_blocks.1.self_attention |      2.519M            |      0.152G  |
|     net_s.layers_up.0.blocks.0.smm_blocks.2                 |     2.52M              |     0.152G   |
|      net_s.layers_up.0.blocks.0.smm_blocks.2.ln_1           |      1.024K            |      0.164M  |
|      net_s.layers_up.0.blocks.0.smm_blocks.2.self_attention |      2.519M            |      0.152G  |
|    net_s.layers_up.0.blocks.0.conv1b3                       |    0.263M              |    16.908M   |
|     net_s.layers_up.0.blocks.0.conv1b3.0                    |     0.263M             |     16.777M  |
|      net_s.layers_up.0.blocks.0.conv1b3.0.weight            |      (512, 512, 1, 1)  |              |
|      net_s.layers_up.0.blocks.0.conv1b3.0.bias              |      (512,)            |              |
|     net_s.layers_up.0.blocks.0.conv1b3.1                    |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.conv1a3                       |    0.263M              |    16.908M   |
|     net_s.layers_up.0.blocks.0.conv1a3.0                    |     0.263M             |     16.777M  |
|      net_s.layers_up.0.blocks.0.conv1a3.0.weight            |      (512, 512, 1, 1)  |              |
|      net_s.layers_up.0.blocks.0.conv1a3.0.bias              |      (512,)            |              |
|     net_s.layers_up.0.blocks.0.conv1a3.1                    |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.conv1b5                       |    0.263M              |    16.908M   |
|     net_s.layers_up.0.blocks.0.conv1b5.0                    |     0.263M             |     16.777M  |
|      net_s.layers_up.0.blocks.0.conv1b5.0.weight            |      (512, 512, 1, 1)  |              |
|      net_s.layers_up.0.blocks.0.conv1b5.0.bias              |      (512,)            |              |
|     net_s.layers_up.0.blocks.0.conv1b5.1                    |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.conv1a5                       |    0.263M              |    16.908M   |
|     net_s.layers_up.0.blocks.0.conv1a5.0                    |     0.263M             |     16.777M  |
|      net_s.layers_up.0.blocks.0.conv1a5.0.weight            |      (512, 512, 1, 1)  |              |
|      net_s.layers_up.0.blocks.0.conv1a5.0.bias              |      (512,)            |              |
|     net_s.layers_up.0.blocks.0.conv1a5.1                    |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.conv33.0                      |    4.608K              |              |
|     net_s.layers_up.0.blocks.0.conv33.0.weight              |     (512, 1, 3, 3)     |              |
|    net_s.layers_up.0.blocks.0.conv55                        |    12.8K               |    0.95M     |
|     net_s.layers_up.0.blocks.0.conv55.0                     |     12.8K              |     0.819M   |
|      net_s.layers_up.0.blocks.0.conv55.0.weight             |      (512, 1, 5, 5)    |              |
|     net_s.layers_up.0.blocks.0.conv55.1                     |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.conv77                        |    25.088K             |    1.737M    |
|     net_s.layers_up.0.blocks.0.conv77.0                     |     25.088K            |     1.606M   |
|      net_s.layers_up.0.blocks.0.conv77.0.weight             |      (512, 1, 7, 7)    |              |
|     net_s.layers_up.0.blocks.0.conv77.1                     |                        |     0.131M   |
|    net_s.layers_up.0.blocks.0.finalconv11                   |    0.787M              |    50.332M   |
|     net_s.layers_up.0.blocks.0.finalconv11.weight           |     (512, 1536, 1, 1)  |              |
|     net_s.layers_up.0.blocks.0.finalconv11.bias             |     (512,)             |              |
|   net_s.layers_up.1                                         |   4.432M               |   0.961G     |
|    net_s.layers_up.1.blocks                                 |    3.908M              |    0.928G    |
|     net_s.layers_up.1.blocks.0                              |     1.954M             |     0.464G   |
|      net_s.layers_up.1.blocks.0.smm_blocks                  |      1.473M            |      0.34G   |
|      net_s.layers_up.1.blocks.0.conv1b3                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.0.conv1a3                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.0.conv1b5                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.0.conv1a5                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.0.conv33.0                    |      2.304K            |              |
|      net_s.layers_up.1.blocks.0.conv55                      |      6.4K              |      1.901M  |
|      net_s.layers_up.1.blocks.0.conv77                      |      12.544K           |      3.473M  |
|      net_s.layers_up.1.blocks.0.finalconv11                 |      0.197M            |      50.332M |
|     net_s.layers_up.1.blocks.1                              |     1.954M             |     0.464G   |
|      net_s.layers_up.1.blocks.1.smm_blocks                  |      1.473M            |      0.34G   |
|      net_s.layers_up.1.blocks.1.conv1b3                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.1.conv1a3                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.1.conv1b5                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.1.conv1a5                     |      65.792K           |      17.039M |
|      net_s.layers_up.1.blocks.1.conv33.0                    |      2.304K            |              |
|      net_s.layers_up.1.blocks.1.conv55                      |      6.4K              |      1.901M  |
|      net_s.layers_up.1.blocks.1.conv77                      |      12.544K           |      3.473M  |
|      net_s.layers_up.1.blocks.1.finalconv11                 |      0.197M            |      50.332M |
|    net_s.layers_up.1.upsample                               |    0.525M              |    33.882M   |
|     net_s.layers_up.1.upsample.expand                       |     0.524M             |     33.554M  |
|      net_s.layers_up.1.upsample.expand.weight               |      (1024, 512)       |              |
|     net_s.layers_up.1.upsample.norm                         |     0.512K             |     0.328M   |
|      net_s.layers_up.1.upsample.norm.weight                 |      (256,)            |              |
|      net_s.layers_up.1.upsample.norm.bias                   |      (256,)            |              |
|   net_s.layers_up.2                                         |   1.816M               |   1.529G     |
|    net_s.layers_up.2.blocks                                 |    1.685M              |    1.495G    |
|     net_s.layers_up.2.blocks.0                              |     0.842M             |     0.747G   |
|      net_s.layers_up.2.blocks.0.smm_blocks                  |      0.717M            |      0.617G  |
|      net_s.layers_up.2.blocks.0.conv1b3                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.0.conv1a3                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.0.conv1b5                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.0.conv1a5                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.0.conv33.0                    |      1.152K            |              |
|      net_s.layers_up.2.blocks.0.conv55                      |      3.2K              |      3.801M  |
|      net_s.layers_up.2.blocks.0.conv77                      |      6.272K            |      6.947M  |
|      net_s.layers_up.2.blocks.0.finalconv11                 |      49.28K            |      50.332M |
|     net_s.layers_up.2.blocks.1                              |     0.842M             |     0.747G   |
|      net_s.layers_up.2.blocks.1.smm_blocks                  |      0.717M            |      0.617G  |
|      net_s.layers_up.2.blocks.1.conv1b3                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.1.conv1a3                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.1.conv1b5                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.1.conv1a5                     |      16.512K           |      17.302M |
|      net_s.layers_up.2.blocks.1.conv33.0                    |      1.152K            |              |
|      net_s.layers_up.2.blocks.1.conv55                      |      3.2K              |      3.801M  |
|      net_s.layers_up.2.blocks.1.conv77                      |      6.272K            |      6.947M  |
|      net_s.layers_up.2.blocks.1.finalconv11                 |      49.28K            |      50.332M |
|    net_s.layers_up.2.upsample                               |    0.131M              |    34.21M    |
|     net_s.layers_up.2.upsample.expand                       |     0.131M             |     33.554M  |
|      net_s.layers_up.2.upsample.expand.weight               |      (512, 256)        |              |
|     net_s.layers_up.2.upsample.norm                         |     0.256K             |     0.655M   |
|      net_s.layers_up.2.upsample.norm.weight                 |      (128,)            |              |
|      net_s.layers_up.2.upsample.norm.bias                   |      (128,)            |              |
|   net_s.layers_up.3                                         |   0.349M               |   1.009G     |
|    net_s.layers_up.3.blocks.0                               |    0.316M              |    0.974G    |
|     net_s.layers_up.3.blocks.0.smm_blocks                   |     0.281M             |     0.831G   |
|      net_s.layers_up.3.blocks.0.smm_blocks.0                |      93.824K           |      0.277G  |
|      net_s.layers_up.3.blocks.0.smm_blocks.1                |      93.824K           |      0.277G  |
|      net_s.layers_up.3.blocks.0.smm_blocks.2                |      93.824K           |      0.277G  |
|     net_s.layers_up.3.blocks.0.conv1b3                      |     4.16K              |     17.826M  |
|      net_s.layers_up.3.blocks.0.conv1b3.0                   |      4.16K             |      16.777M |
|      net_s.layers_up.3.blocks.0.conv1b3.1                   |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.conv1a3                      |     4.16K              |     17.826M  |
|      net_s.layers_up.3.blocks.0.conv1a3.0                   |      4.16K             |      16.777M |
|      net_s.layers_up.3.blocks.0.conv1a3.1                   |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.conv1b5                      |     4.16K              |     17.826M  |
|      net_s.layers_up.3.blocks.0.conv1b5.0                   |      4.16K             |      16.777M |
|      net_s.layers_up.3.blocks.0.conv1b5.1                   |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.conv1a5                      |     4.16K              |     17.826M  |
|      net_s.layers_up.3.blocks.0.conv1a5.0                   |      4.16K             |      16.777M |
|      net_s.layers_up.3.blocks.0.conv1a5.1                   |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.conv33.0                     |     0.576K             |              |
|      net_s.layers_up.3.blocks.0.conv33.0.weight             |      (64, 1, 3, 3)     |              |
|     net_s.layers_up.3.blocks.0.conv55                       |     1.6K               |     7.602M   |
|      net_s.layers_up.3.blocks.0.conv55.0                    |      1.6K              |      6.554M  |
|      net_s.layers_up.3.blocks.0.conv55.1                    |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.conv77                       |     3.136K             |     13.894M  |
|      net_s.layers_up.3.blocks.0.conv77.0                    |      3.136K            |      12.845M |
|      net_s.layers_up.3.blocks.0.conv77.1                    |                        |      1.049M  |
|     net_s.layers_up.3.blocks.0.finalconv11                  |     12.352K            |     50.332M  |
|      net_s.layers_up.3.blocks.0.finalconv11.weight          |      (64, 192, 1, 1)   |              |
|      net_s.layers_up.3.blocks.0.finalconv11.bias            |      (64,)             |              |
|    net_s.layers_up.3.upsample                               |    32.896K             |    34.865M   |
|     net_s.layers_up.3.upsample.expand                       |     32.768K            |     33.554M  |
|      net_s.layers_up.3.upsample.expand.weight               |      (256, 128)        |              |
|     net_s.layers_up.3.upsample.norm                         |     0.128K             |     1.311M   |
|      net_s.layers_up.3.upsample.norm.weight                 |      (64,)             |              |
|      net_s.layers_up.3.upsample.norm.bias                   |      (64,)             |              |
---------------------------------------------------------------------------------
2024-09-23 20:16:05,486 - ==> Creating optimizer
2024-09-23 20:16:05,488 - ==> Loading dataset: DefaultAD
2024-09-23 20:16:05,496 - ==> ********** cfg ********** 
fvcore_is                            : True                                
fvcore_b                             : 1                                   
fvcore_c                             : 3                                   
epoch_full                           : 300                                 
metrics                              : ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px']
use_adeval                           : True                                
evaluator.kwargs                     : {'metrics': ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px'], 'pooling_ks': None, 'max_step_aupro': 100}
vis                                  : True                                
vis_dir                              : result/                             
optim.lr                             : 0.005                               
optim.kwargs                         : {'name': 'adamw', 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0.0001, 'amsgrad': False}
trainer.name                         : MAMBAADTrainer                      
trainer.checkpoint                   : runs                                
trainer.logdir_sub                   :                                     
trainer.resume_dir                   :                                     
trainer.cuda_deterministic           : False                               
trainer.epoch_full                   : 300                                 
trainer.scheduler_kwargs             : {'name': 'step', 'lr_noise': None, 'noise_pct': 0.67, 'noise_std': 1.0, 'noise_seed': 42, 'lr_min': 5e-05, 'warmup_lr': 5e-06, 'warmup_iters': -1, 'cooldown_iters': 0, 'warmup_epochs': 0, 'cooldown_epochs': 0, 'use_iters': True, 'patience_iters': 0, 'patience_epochs': 0, 'decay_iters': 0, 'decay_epochs': 240, 'cycle_decay': 0.1, 'decay_rate': 0.1}
trainer.mixup_kwargs                 : {'mixup_alpha': 0.8, 'cutmix_alpha': 1.0, 'cutmix_minmax': None, 'prob': 0.0, 'switch_prob': 0.5, 'mode': 'batch', 'correct_lam': True, 'label_smoothing': 0.1}
trainer.test_start_epoch             : 300                                 
trainer.test_per_epoch               : 15                                  
trainer.find_unused_parameters       : False                               
trainer.sync_BN                      : apex                                
trainer.dist_BN                      :                                     
trainer.scaler                       : none                                
trainer.data.batch_size              : 16                                  
trainer.data.batch_size_per_gpu      : 16                                  
trainer.data.batch_size_test         : 16                                  
trainer.data.batch_size_per_gpu_test : 16                                  
trainer.data.num_workers_per_gpu     : 4                                   
trainer.data.drop_last               : True                                
trainer.data.pin_memory              : True                                
trainer.data.persistent_workers      : False                               
trainer.data.num_workers             : 4                                   
trainer.iter                         : 0                                   
trainer.epoch                        : 0                                   
trainer.iter_full                    : 35400                               
trainer.metric_recorder              : {'mAUROC_sp_max_road': [], 'mAP_sp_max_road': [], 'mF1_max_sp_max_road': [], 'mAUPRO_px_road': [], 'mAUROC_px_road': [], 'mAP_px_road': [], 'mF1_max_px_road': [], 'mF1_px_0.2_0.8_0.1_road': [], 'mAcc_px_0.2_0.8_0.1_road': [], 'mIoU_px_0.2_0.8_0.1_road': [], 'mIoU_max_px_road': []}
loss.loss_terms                      : [{'type': 'L2Loss', 'name': 'pixel', 'lam': 5.0}]
loss.clip_grad                       : 5.0                                 
loss.create_graph                    : False                               
loss.retain_graph                    : False                               
adv                                  : False                               
logging.log_terms_train              : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'data_t', 'fmt': ':>5.3f'}, {'name': 'optim_t', 'fmt': ':>5.3f'}, {'name': 'lr', 'fmt': ':>7.6f'}, {'name': 'cos', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.log_terms_test               : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'cos', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.train_reset_log_per          : 50                                  
logging.train_log_per                : 50                                  
logging.test_log_per                 : 50                                  
data.sampler                         : naive                               
data.loader_type                     : pil                                 
data.loader_type_target              : pil_L                               
data.type                            : DefaultAD                           
data.root                            : data/mvtec                          
data.meta                            : meta.json                           
data.cls_names                       : []                                  
data.train_transforms                : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.test_transforms                 : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.target_transforms               : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}]
data.train_size                      : 118                                 
data.test_size                       : 92                                  
data.train_length                    : 1896                                
data.test_length                     : 1472                                
model_t.name                         : timm_resnet34                       
model_t.kwargs                       : {'pretrained': True, 'checkpoint_path': 'model/pretrain/resnet34-43635321.pth', 'strict': False, 'features_only': True, 'out_indices': [1, 2, 3]}
model_s                              : {'depths_decoder': [3, 4, 6, 3], 'scan_type': 'hilbert', 'num_direction': 8}
model.name                           : mambaad                             
model.kwargs                         : {'pretrained': False, 'checkpoint_path': '/data/x2/ader/runs/MAMBAADTrainer_configs_mambaad_mambaad_mvtec_20240923-113322/net.pth', 'strict': True, 'model_t': Namespace(name='timm_resnet34', kwargs={'pretrained': True, 'checkpoint_path': 'model/pretrain/resnet34-43635321.pth', 'strict': False, 'features_only': True, 'out_indices': [1, 2, 3]}), 'model_s': {'depths_decoder': [3, 4, 6, 3], 'scan_type': 'hilbert', 'num_direction': 8}}
seed                                 : 42                                  
size                                 : 256                                 
warmup_epochs                        : 0                                   
test_start_epoch                     : 300                                 
test_per_epoch                       : 15                                  
batch_train                          : 16                                  
batch_test_per                       : 16                                  
lr                                   : 0.005                               
weight_decay                         : 0.0001                              
cfg_path                             : configs.mambaad.mambaad_mvtec       
mode                                 : test                                
sleep                                : -1                                  
memory                               : -1                                  
dist_url                             : env://                              
logger_rank                          : 0                                   
opts                                 : ['vis=True', 'vis_dir=result/']     
command                              : python3 -m torch.distributed.launch --nproc_per_node=$nproc_per_node --nnodes=$nnodes --node_rank=$node_rank --master_addr=$master_addr --master_port=$master_port --use_env run.py -c configs.mambaad.mambaad_mvtec -m test --sleep -1 --memory -1 --dist_url env:// --logger_rank 0 vis=True vis_dir=result/
task_start_time                      : 1841690.223883379                   
dist                                 : False                               
world_size                           : 1                                   
rank                                 : 0                                   
local_rank                           : 0                                   
ngpus_per_node                       : 1                                   
nnodes                               : 1                                   
master                               : True                                
logdir                               : runs/MAMBAADTrainer_configs_mambaad_mambaad_mvtec_20240923-201602
logger.filters                       : []                                  
logger.name                          : root                                
logger.level                         : 20                                  
logger.parent                        : None                                
logger.propagate                     : True                                
logger.disabled                      : False                               
logdir_train                         : runs/MAMBAADTrainer_configs_mambaad_mambaad_mvtec_20240923-201602/show_train
logdir_test                          : runs/MAMBAADTrainer_configs_mambaad_mambaad_mvtec_20240923-201602/show_test
2024-09-23 20:16:05,497 - ==> Starting testing with 1 nodes x 1 GPUs
2024-09-23 20:16:38,510 - Test: 54.35% [50/92] [batch_t 0.598 (0.658)]
2024-09-23 20:17:04,463 - Test: 100.00% [92/92] [batch_t 0.508 (0.640)]
2024-09-23 20:21:45,583 - ==> Metric Time for road           :   0.003 (mAUROC_sp_max)	  0.001 (mAP_sp_max)	  0.001 (mF1_max_sp_max)	175.341 (mAUPRO_px)	 51.432 (mAUROC_px)	 34.913 (mAP_px)	  6.027 (mF1_max_px)	  2.052 (mF1_px_0.2_0.8_0.1)	  2.015 (mAcc_px_0.2_0.8_0.1)	  2.043 (mIoU_px_0.2_0.8_0.1)	  5.985 (mIoU_max_px)	
2024-09-23 20:21:45,591 - 
|  Name  |  mAUROC_sp_max  |  mAUROC_sp_max (Max)  |  mAP_sp_max  |  mAP_sp_max (Max)  |  mF1_max_sp_max  |  mF1_max_sp_max (Max)  |  mAUPRO_px  |  mAUPRO_px (Max)   |  mAUROC_px  |  mAUROC_px (Max)   |  mAP_px  |    mAP_px (Max)    |  mF1_max_px  |  mF1_max_px (Max)  |  mF1_px_0.2_0.8_0.1  |  mF1_px_0.2_0.8_0.1 (Max)  |  mAcc_px_0.2_0.8_0.1  |  mAcc_px_0.2_0.8_0.1 (Max)  |  mIoU_px_0.2_0.8_0.1  |  mIoU_px_0.2_0.8_0.1 (Max)  |  mIoU_max_px  |  mIoU_max_px (Max)  |
|:------:|:---------------:|:---------------------:|:------------:|:------------------:|:----------------:|:----------------------:|:-----------:|:------------------:|:-----------:|:------------------:|:--------:|:------------------:|:------------:|:------------------:|:--------------------:|:--------------------------:|:---------------------:|:---------------------------:|:---------------------:|:---------------------------:|:-------------:|:-------------------:|
|  road  |     86.906      |  86.906 (1   epoch)   |    95.551    | 95.551 (1   epoch) |      89.704      |   89.704 (1   epoch)   |   53.033    | 53.033 (1   epoch) |   87.654    | 87.654 (1   epoch) |  31.940  | 31.940 (1   epoch) |    36.977    | 36.977 (1   epoch) |        15.147        |     15.147 (1   epoch)     |        42.691         |     42.691 (1   epoch)      |         8.700         |      8.700 (1   epoch)      |    22.682     | 22.682 (1   epoch)  |
